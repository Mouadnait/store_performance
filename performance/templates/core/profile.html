{% extends 'base.html' %}
{% load static %}

{% block style-content %}
<link rel="stylesheet" href="{% static 'css/profile.css' %}">
<style>
.profile-container {max-width:1200px;margin:0 auto;padding:30px;}
.profile-grid {display:grid;grid-template-columns:320px 1fr;gap:30px;align-items:start;}
.profile-card-sidebar {background:#fff;border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,0.08);position:sticky;top:30px;}
.profile-cover {height:100px;background:linear-gradient(135deg,#667eea,#764ba2);}
.profile-avatar-section {text-align:center;margin-top:-50px;padding:0 30px 30px;}
.avatar-img {width:100px;height:100px;border-radius:50%;border:4px solid #fff;box-shadow:0 4px 12px rgba(0,0,0,0.15);object-fit:cover;}
.profile-name {font-size:22px;font-weight:700;color:#1f2937;margin:15px 0 5px;}
.profile-email {color:#6b7280;font-size:13px;}
.profile-badge {display:inline-block;padding:5px 15px;border-radius:20px;background:linear-gradient(135deg,#f0abfc,#c084fc);color:#fff;font-size:11px;font-weight:600;margin:10px 0 20px;}
.profile-stats {display:grid;grid-template-columns:1fr 1fr;gap:15px;padding:20px 0;border-top:1px solid #e5e7eb;}
.stat-item {text-align:center;}
.stat-value {font-size:24px;font-weight:700;color:#667eea;}
.stat-label {font-size:11px;color:#6b7280;margin-top:4px;}
.profile-meta {background:#f9fafb;padding:15px;border-radius:10px;text-align:left;margin-top:15px;}
.meta-item {display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid #e5e7eb;font-size:13px;}
.meta-item:last-child {border-bottom:none;}
.profile-section {background:#fff;border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,0.08);margin-bottom:25px;}
.section-header {padding:25px 30px;border-bottom:1px solid #e5e7eb;display:flex;align-items:center;gap:10px;}
.section-header h2 {font-size:20px;font-weight:700;color:#1f2937;margin:0;}
.section-header .material-icons-sharp {color:#667eea;}
.section-body {padding:30px;}
.form-grid {display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px;}
.form-grid.single {grid-template-columns:1fr;}
.form-field label {display:block;font-size:14px;font-weight:600;color:#374151;margin-bottom:8px;}
.form-field input,.form-field textarea {width:100%;padding:12px 16px;border:2px solid #e5e7eb;border-radius:10px;font-size:14px;transition:all .3s;}
.form-field input:focus,.form-field textarea:focus {border-color:#667eea;outline:none;box-shadow:0 0 0 3px rgba(102,126,234,0.1);}
.form-field textarea {resize:vertical;min-height:100px;}
.form-field .hint {font-size:12px;color:#6b7280;margin-top:6px;}
.form-actions {display:flex;gap:12px;padding-top:20px;border-top:1px solid #e5e7eb;}
.btn {padding:12px 24px;border-radius:10px;font-weight:600;font-size:14px;display:inline-flex;align-items:center;gap:8px;cursor:pointer;transition:all .3s;border:none;text-decoration:none;}
.btn-primary {background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;}
.btn-primary:hover {transform:translateY(-2px);box-shadow:0 8px 20px rgba(102,126,234,0.4);}
.btn-secondary {background:#e5e7eb;color:#374151;}
.btn-secondary:hover {background:#d1d5db;}
.alert {padding:16px 20px;border-radius:10px;margin-bottom:20px;display:flex;align-items:center;gap:12px;}
.alert-success {background:#d1fae5;color:#065f46;border:1px solid #6ee7b7;}
.alert-error {background:#fee2e2;color:#991b1b;border:1px solid #fca5a5;}
@media(max-width:1024px){.profile-grid{grid-template-columns:1fr;}.profile-card-sidebar{position:relative;top:0;}.form-grid{grid-template-columns:1fr;}}
</style>
{% endblock style-content %}

{% block title %}My Profile | Store Performance{% endblock title %}
{% block content-title %}My Profile{% endblock content-title %}

{% block content %}
<div class="profile-container">
<div class="profile-grid">
<div class="profile-card-sidebar">
<div class="profile-cover"></div>
<div class="profile-avatar-section">
<img src="{% if profile_image %}{{profile_image}}{% else %}{% static 'images/default-profile.png' %}{% endif %}" alt="Profile" class="avatar-img">
<div class="profile-name">{{user.first_name}} {{user.last_name}}</div>
<div class="profile-email">{{user.email}}</div>
<div class="profile-badge">{% if is_admin %}Administrator{% else %}Store Owner{% endif %}</div>
<div class="profile-stats">
<div class="stat-item"><span class="stat-value">{{user_products|default:"0"}}</span><div class="stat-label">Products</div></div>
<div class="stat-item"><span class="stat-value">{{user_clients|default:"0"}}</span><div class="stat-label">Clients</div></div>
<div class="stat-item"><span class="stat-value">{{user_bills|default:"0"}}</span><div class="stat-label">Bills</div></div>
<div class="stat-item"><span class="stat-value">${{total_revenue|default:"0"|floatformat:0}}</span><div class="stat-label">Revenue</div></div>
</div>
<div class="profile-meta">
<div class="meta-item"><span style="color:#6b7280;">Member Since</span><span style="font-weight:600;">{{user.date_joined|date:"M Y"}}</span></div>
<div class="meta-item"><span style="color:#6b7280;">Last Login</span><span style="font-weight:600;">{% if user.last_login %}{{user.last_login|date:"M d"}}{% else %}Never{% endif %}</span></div>
<div class="meta-item"><span style="color:#6b7280;">Status</span><span style="color:#10b981;font-weight:600;">Active</span></div>
</div>
</div>
</div>
<div>
{% if messages %}
{% for message in messages %}
<div class="alert alert-{{message.tags}}"><span class="material-icons-sharp">{% if message.tags == 'success' %}check_circle{% else %}error{% endif %}</span>{{message}}</div>
{% endfor %}
{% endif %}
<div class="profile-section">
<div class="section-header"><span class="material-icons-sharp">person</span><h2>Personal Information</h2></div>
<div class="section-body">
<form method="POST" enctype="multipart/form-data">
{% csrf_token %}
<div class="form-grid">
<div class="form-field"><label>Username *</label><input type="text" name="username" value="{{user.username}}" required></div>
<div class="form-field"><label>Email Address *</label><input type="email" name="email" value="{{user.email}}" required></div>
</div>
<div class="form-grid">
<div class="form-field"><label>First Name</label><input type="text" name="first_name" value="{{user.first_name|default:''}}"></div>
<div class="form-field"><label>Last Name</label><input type="text" name="last_name" value="{{user.last_name|default:''}}"></div>
</div>
<div class="form-grid single">
<div class="form-field"><label>Phone Number</label><input type="tel" name="phone" value="{{user.phone|default:''}}" placeholder="+1 (555) 123-4567"><span class="hint">Include country code</span></div>
</div>
<div class="form-grid single">
<div class="form-field"><label>Bio</label><textarea name="bio" maxlength="500" placeholder="Tell us about yourself...">{{user.bio|default:''}}</textarea><span class="hint">Maximum 500 characters</span></div>
</div>
<div class="form-grid single">
<div class="form-field"><label>Profile Photo</label><input type="file" name="image" accept="image/*"><span class="hint">Max 5MB, recommended 400x400px</span></div>
</div>
<div class="form-actions">
<button type="submit" class="btn btn-primary"><span class="material-icons-sharp">save</span>Save Changes</button>
<a href="{% url 'core:dashboard' %}" class="btn btn-secondary"><span class="material-icons-sharp">close</span>Cancel</a>
</div>
</form>
</div>
</div>
</div>
</div>
</div>
{% endblock content %}
